!function(a,b){a.ytp=a.ytp||function(){var c,d,e,f,g,h,i="0.0.2",j=[],k=!1,l=[],m=[],n=!1;return{isApiReady:function(){return n},setVideoOptions:function(a){e=a},setId:function(a){c=a},init:function(){console.log("init player"),ytp.getLocation(),d=ytp.makeSessionId(),a.onYouTubeIframeAPIReady=function(){return function(){return n=!0,ytp.initializeVideo()}}(this);var b=document.createElement("script");b.src="https://www.youtube.com/iframe_api";var c=document.getElementsByTagName("script")[0];return c.parentNode.insertBefore(b,c),this},initializeVideo:function(){return f=new YT.Player(c,{width:e.width,height:e.height,videoId:e.videoId,playerVars:e.playerVars,events:{onReady:e.onReady,onStateChange:function(a){ytp.onPlayerStateChange(a)},onPlaybackQualityChange:e.onPlaybackQualityChange,onPlaybackRateChange:e.onPlaybackRateChange,onApiChange:e.onApiChange,onError:e.onError}}),console.log("player loaded"),this},onPlayerStateChange:function(a){switch(g=a.data,e.onStateChange(a),a.data){case 0:"function"==typeof e.onEnd?e.onEnd(a):void 0;break;case 1:"function"==typeof e.onPlay?e.onPlay(a):void 0,k||ytp.collectStats(),ytp.showSlides();break;case 2:"function"==typeof e.onPause?e.onPause(a):void 0,ytp.sendStats();break;case 3:"function"==typeof e.onBuffer?e.onBuffer(a):void 0}},play:function(){return f.playVideo(),this},pause:function(){return f.pauseVideo(),this},seekTo:function(a){return f.seekTo(a),this},volume:function(a){return f.setVolume(a),this},mute:function(){return f.mute(),this},getPlayer:function(){return f},version:function(){return i},addEventListener:function(a,b){return console.log("player "+f),f.addEventListener(a,b),this},removeEventListener:function(a,b){return f.removeEventListener(a,b),this},collectStats:function(){var b=0,c=0;k=!0,a.setInterval(function(){b=f.getCurrentTime(),1==g&&(c=parseInt(b.toFixed()),l.push(c))},1e3)},buildIntervals:function(){m=[],l=l.sort(function(a,b){return a-b});for(var a,b=l[0],c=0;c<l.length;c++)l[c-1]&&l[c]-l[c-1]>1&&(a=l[c-1],m.push({time_from:b,time_to:a}),b=l[c]);m.push({time_from:b,time_to:l[l.length-1]})},showSlides:function(){var b,c=[];e.slides&&e.slides.forEach(function(d,g){var h=d.from.split(":"),i=d.to.split(":");j.push({isVisible:!1,from:60*+h[0]*60+60*+h[1]+ +h[2],to:60*+i[0]*60+60*+i[1]+ +i[2],content:d.content}),c[g]=a.setInterval(function(){b=f.getCurrentTime(),b>=j[g].from&&b<=j[g].to?j[g].isVisible||(e.playerSidebar.html(j[g].content),e.playerSidebar.removeClass("zoomOutUp").addClass("lightSpeedIn"),j[g].isVisible=!0):j[g].isVisible&&(e.playerSidebar.removeClass("lightSpeedIn").addClass("zoomOutUp"),j[g].isVisible=!1)},1e3)})},makeSessionId:function(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;5>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a},getLocation:function(){b.ajax({url:"//freegeoip.net/json/",type:"POST",dataType:"jsonp",success:function(a){h=a.country_code}})},beforeUnload:function(){var a=f.getCurrentTime();this.sendStats(a)},sendStats:function(){var c,g="http://127.0.0.1:8888/",i=navigator.userAgent,j=navigator.appName;ytp.buildIntervals(),-1!=(c=i.indexOf("Opera"))?j="Opera":-1!=(c=i.indexOf("MSIE"))?j="IE":-1!=(c=i.indexOf("Chrome"))?j="Chrome":-1!=(c=i.indexOf("Safari"))?j="Safari":-1!=(c=i.indexOf("Firefox"))&&(j="Firefox");var k={intervals:m,sessionId:d,videoId:e.videoId,videoLength:f.getDuration().toFixed(),browserName:j,location:h,ref:a.location.href};b.ajax({type:"POST",url:g,data:k,success:function(){console.log(" DATA "+JSON.stringify(k,null,4)+" SENT!")},error:function(){console.log("ERROR SENDING DATA!")}})},YTPlayer:function(){var b=a.YTPlayerSettings||{};return b.id="YTPlayerContainer",b.width=b.width||640,b.height=b.height||480,b.playerSidebar=b.sidebar&&b.sidebar.css({height:b.height,width:b.width}),b.videoId=b.videoId||"OPf0YbXqDm0",b.playerVars=b.playerVars||{},b.slides=b.slides|{},ytp.setVideoOptions(b),ytp.setId(b.id),ytp.isApiReady()?ytp.initializeVideo():ytp.init()}}}()}(window,window.jQuery);